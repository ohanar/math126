(function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}};t=function(){t.prototype.HEIGHT=400;t.prototype.WIDTH=650;t.prototype.shadow=null;t.prototype.guiActive=false;t.prototype.live=false;t.prototype.animated=false;t.prototype.initTime=3e3;t.prototype.showingObjects=false;t.UWMaterial=new THREE.MeshPhongMaterial({ambient:3745627,color:13080832,specular:1118481,shininess:20,side:THREE.DoubleSide});function t(t){this.animate=e(this.animate,this);this.render=e(this.render,this);this.kill=e(this.kill,this);this.birth=e(this.birth,this);this.create=e(this.create,this);this.replaceStaticImage=e(this.replaceStaticImage,this);this.setCameraControls=e(this.setCameraControls,this);var i;if(t!=null){this.container=document.getElementById(t)}else{this.container=document.body.appendChild(document.createElement("div"))}this.container.style.position="relative";this.WIDTH=Math.min(650,window.innerWidth-10);this.HEIGHT=Math.floor(this.WIDTH*400/650);i=this.populate();if(!i){return}this.mathUp();this.shadow=false;this.guiActive=false;return}t.prototype.setrenderer=function(){if(Detector.webgl){this.renderer=new THREE.WebGLRenderer({preserveDrawingBuffer:true,antialias:true});this.renderer.setClearColor(1118481,1)}else{this.renderer=new THREE.CanvasRenderer}};t.prototype.setCameraControls=function(){this.cameraControls=new THREE.TrackballControls(this.camera,this.renderer.domElement);this.cameraControls.target.set(0,0,0);this.cameraControls.addEventListener("end",this.kill);this.cameraControls.addEventListener("start",this.birth);return null};t.prototype.enableShadow=function(){this.renderer.shadowMapEnabled=true;this.renderer.shadowMapSoft=true;this.renderer.shadowMapBias=.0039;this.renderer.shadowMapDarkness=1;this.renderer.shadowMapWidth=1024;this.renderer.shadowMapHeight=1024;return null};t.prototype.replaceStaticImage=function(){var t,e,i,n;e=this.container.getElementsByTagName("img");for(i=0,n=e.length;i<n;i++){t=e[i];t.style.display="none"}this.renderer.domElement.style.display="block";this.cameraControls.handleResize();this.showGui();return null};t.prototype.populate=function(){if(!Detector.webgl){return false}this.scene=new THREE.Scene;this.scene.add(new THREE.AmbientLight(16777215));this.scene.add(new THREE.DirectionalLight(16777215));if(!this.camera){this.camera=new THREE.PerspectiveCamera(45,this.WIDTH/this.HEIGHT);this.camera.position.set(3,3,3)}if(this.shadow){this.enableShadow();this.pointLight=new THREE.SpotLight(16777215);this.pointLight.castShadow=true}else{this.pointLight=new THREE.PointLight(16777215)}this.pointLight.intensity=1;this.pointLight.position.set(0,0,100);this.scene.add(this.pointLight);this.scene.add(this.camera);this.setrenderer();this.renderer.setSize(this.WIDTH,this.HEIGHT);this.renderer.domElement.style.position="relative";this.renderer.domElement.style.display="none";this.container.appendChild(this.renderer.domElement);this.renderer.clear();this.gui=new dat.GUI({autoPlace:false});this.gui.domElement.style.position="absolute";this.gui.domElement.style.left=0;this.gui.domElement.style.top=0;this.gui.close();this.gui.add(this,"generateSnapshot").name("Take picture");this.activateGui();this.hideGui();this.setCameraControls();return true};t.prototype.create=function(){this.birth();setTimeout(this.kill,this.initTime);return this.showingObjects=true};t.prototype.birth=function(){this.live=true;this.animate()};t.prototype.kill=function(){this.replaceStaticImage();this.live=false};t.prototype.generateSnapshot=function(){var t,e;this.hideGui();t=this.renderer.domElement.toDataURL();e=document.createElement("img");e.src=t;this.container.appendChild(e);this.showGui()};t.prototype.loadSnapshot=function(){throw"Not yet implemented"};t.prototype.activateGui=function(){if(!this.guiActive){this.container.appendChild(this.gui.domElement);this.guiActive=true}return null};t.prototype.hideGui=function(){this.gui.domElement.style.display="none"};t.prototype.showGui=function(){this.gui.domElement.style.display=""};t.prototype.mathUp=function(){return this.camera.up=new THREE.Vector3(0,0,1)};t.prototype.addaxes=function(t){this.scene.add(new THREE.AxisHelper(t));return null};t.prototype.render=function(){var t;if((t=this.cameraControls)!=null){t.update()}this.pointLight.position=this.camera.position;this.renderer.render(this.scene,this.camera);return null};t.prototype.calc=function(t){};t.prototype.animate=function(){var t,e;e=this;t=function(i){e.calc(i);e.render();if(e.animated||e.live){requestAnimationFrame(t,e.container)}return null};t((new Date).getTime());return null};t.prototype.add=function(t){this.create();this.scene.add(t);return null};return t}();window.MathScene=t}).call(this);