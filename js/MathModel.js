(function(){var e,t,i,n,o,s,r={}.hasOwnProperty,a=function(e,t){for(var i in t){if(r.call(t,i))e[i]=t[i]}function n(){this.constructor=e}n.prototype=t.prototype;e.prototype=new n;e.__super__=t.prototype;return e},l=function(e,t){return function(){return e.apply(t,arguments)}};i=function(){function e(){}e.prototype.calc=null;e.prototype.needsGui=false;e.prototype.embedInScene=function(e){var t,i;t=this;t.mathScene=e;t.embedObjects();i=e.calc;e.calc=function(e){if(t.calc!=null){t.calc()(e)}i(e);return null};if(t.needsGui){t.addGui(e.gui)}if(!e.showingObjects){e.create()}return null};return e}();n=function(e){a(t,e);t.prototype.limits=[-1,1];t.prototype.speed=2;t.prototype.minSpeedLimit=.001;t.prototype.resolution=100;t.prototype.mover=null;t.prototype.calc=null;t.prototype.objects=null;t.prototype.needsGui=false;t.prototype.changeEvent={type:"change"};function t(e,t,i,n,o,s){this.x=e;this.y=t;this.z=i;if(n==null){n=[-1,1]}if(o==null){o=2}if(s==null){s=100}this.limits=n;this.speed=o;this.mover=new THREE.Mesh(new THREE.SphereGeometry(.03),new THREE.MeshNormalMaterial);if(this.speed>this.minSpeedLimit){this.calc=function(){var e;e=this;return function(t){var i;i=e.speed*t/1e3;e.mover.position.set(e.x(i),e.y(i),e.z(i));return null}}}this.generate()}t.prototype.generate=function(){var e,t,i,n,o;e=new THREE.Geometry;for(t=n=1,o=this.resolution;1<=o?n<=o:n>=o;t=1<=o?++n:--n){i=this.limits[0]+(this.limits[1]-this.limits[0])*t/(1*this.resolution);e.vertices.push(new THREE.Vector3(this.x(i),this.y(i),this.z(i)))}this.path=new THREE.Line(e,new THREE.LineBasicMaterial({color:16711680}))};t.prototype.embedObjects=function(){if(this.speed>this.minSpeedLimit){this.mathScene.scene.add(this.mover);this.mathScene.animated=true}return this.mathScene.scene.add(this.path)};return t}(i);e=function(e){a(t,e);t.prototype.xmin=-3;t.prototype.xmax=3;t.prototype.ymin=-3;t.prototype.ymax=3;t.prototype.level=0;t.prototype.func=null;t.prototype.resolution=40;t.prototype.calc=null;t.prototype.smoothingLevel=0;t.prototype.needsGui=false;t.prototype.name="";t.prototype.curve=null;t.prototype.algorithm=null;function t(e){this.func=e.func,this.xmin=e.xmin,this.xmax=e.xmax,this.ymin=e.ymin,this.ymax=e.ymax,this.resolution=e.resolution,this.smoothingLevel=e.smoothingLevel,this.material=e.material,this.name=e.name,this.algorithm=e.algorithm;if(this.xmin==null){this.xmin=-3}if(this.xmax==null){this.xmax=3}if(this.ymin==null){this.ymin=-3}if(this.ymax==null){this.ymax=3}if(this.resolution==null){this.resolution=40}if(this.smoothingLevel==null){this.smoothingLevel=0}if(this.material==null){this.material=new THREE.LineBasicMaterial({color:16711680})}if(this.name==null){this.name="Curve"}this.debug=false;if(this.algorithm==null){this.algorithm="marchingSquares"}this.march_async(false);this.needsGui=true}t.prototype.embedObjects=function(){this.march_async(false,this.algorithm);return null};t.prototype.rerender=function(){var e;if(this.mathScene!=null){this.mathScene.scene.remove(this.surface);console.log("surface removed");e=this.march();this.surface=new THREE.Mesh(e,this.material);console.log("surface constructed");this.mathScene.scene.add(this.surface);console.log("surface embedded")}return null};t.prototype.rerender_async=function(){return this.march_async(false,this.algorithm)};t.prototype.addGui=function(e){var t;t=e.addFolder(this.name);t.add(this,"xmin").step(.05);t.add(this,"xmax").step(.05);t.add(this,"ymin").step(.05);t.add(this,"ymax").step(.05);t.add(this,"resolution",40,800).step(1);t.add(this,"rerender_async").name("Render");t.open();return null};t.prototype.march_async=function(e,t){var i,n,o,s,r,a,l,h;if(t==null){t="marchingSquares"}l=this;n=this.debug;window.URL=window.URL||window.webkitURL;s=this.func.toString();r=marchingSquares.toString();a=""+t+" = "+r+"\nself.onmessage = function (e) {\n  output = "+t+"(["+this.resolution+", "+this.resolution+"], "+s+", [["+this.xmin+", "+this.ymin+"],["+this.xmax+", "+this.ymax+"]]);\n  postMessage(output);\n  }";i=null;try{i=new Blob([a],{type:"application/javascript"})}catch(u){o=u;window.BlobBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder;i=new BlobBuilder;i.append(a);i=i.getBlob()}h=new Worker(URL.createObjectURL(i));h.onmessage=function(t){var i,n,o,s,r;r=t.data;n=r.positions;i=r.normals;o=new THREE.BufferGeometry;o.addAttribute("position",new THREE.BufferAttribute(n,3));o.addAttribute("normal",new THREE.BufferAttribute(i,3));s=new THREE.Line(o,l.material,THREE.LinePieces);if(e){if(l.mathScene!=null){l.mathScene.scene.remove(l.surface);console.log("surface removed");l.surface=s;console.log("surface constructed");l.mathScene.scene.add(l.surface);console.log("surface embedded")}}else{if(l.mathScene!=null){l.mathScene.scene.remove(l.surface);l.surface=s;l.mathScene.scene.add(l.surface);l.mathScene.render()}}return null};h.postMessage("Go!");return null};t.prototype.modify=function(e){var t,i;i=e.clone();i.mergeVertices();t=new THREE.SubdivisionModifier(this.smoothingLevel);t.modify(i);return i};return t}(i);t=function(e){a(t,e);t.prototype.xmin=-3;t.prototype.xmax=3;t.prototype.ymin=-3;t.prototype.ymax=3;t.prototype.zmin=-3;t.prototype.zmax=3;t.prototype.level=0;t.prototype.func=null;t.prototype.resolution=40;t.prototype.calc=null;t.prototype.smoothingLevel=0;t.prototype.needsGui=false;t.prototype.name="";t.prototype.surface=null;t.prototype.algorithm=null;function t(e){this.func=e.func,this.xmin=e.xmin,this.xmax=e.xmax,this.ymin=e.ymin,this.ymax=e.ymax,this.zmin=e.zmin,this.zmax=e.zmax,this.resolution=e.resolution,this.smoothingLevel=e.smoothingLevel,this.material=e.material,this.name=e.name,this.algorithm=e.algorithm;this.embedCallback=l(this.embedCallback,this);this.embedObjects=l(this.embedObjects,this);if(this.xmin==null){this.xmin=-3}if(this.xmax==null){this.xmax=3}if(this.ymin==null){this.ymin=-3}if(this.ymax==null){this.ymax=3}if(this.zmin==null){this.zmin=-3}if(this.zmax==null){this.zmax=3}if(this.resolution==null){this.resolution=40}if(this.smoothingLevel==null){this.smoothingLevel=0}if(this.material==null){this.material=new THREE.MeshNormalMaterial({side:THREE.DoubleSide})}if(this.name==null){this.name="Surface"}this.debug=false;if(this.algorithm==null){this.algorithm="surfaceNets"}this.march_async(false);this.needsGui=true}t.prototype.embedObjects=function(){this.march_async(false,this.algorithm);return null};t.prototype.embedCallback=function(){var e,t;e=this;t=e.mathScene.calc;e.mathScene.calc=function(i){if(e.calc!=null){e.calc()(i)}t(i);return null};if(!this.mathScene.showingObjects){e.mathScene.create()}return null};t.prototype.embedInScene=function(e){var t;t=this;t.mathScene=e;if(t.needsGui){t.addGui(t.mathScene.gui)}t.embedObjects();return null};t.prototype.rerender=function(){var e;if(this.mathScene!=null){this.mathScene.scene.remove(this.surface);console.log("surface removed");e=this.march();this.surface=new THREE.Mesh(e,this.material);console.log("surface constructed");this.mathScene.scene.add(this.surface);console.log("surface embedded")}return null};t.prototype.rerender_async=function(){return this.march_async(false,this.algorithm)};t.prototype.addGui=function(e){var t;t=e.addFolder(this.name);t.add(this,"xmin").step(.05);t.add(this,"xmax").step(.05);t.add(this,"ymin").step(.05);t.add(this,"ymax").step(.05);t.add(this,"zmin").step(.05);t.add(this,"zmax").step(.05);t.add(this,"resolution",40,800).step(1);t.add(this,"algorithm",["marchingCubes","surfaceNets"]);t.add(this,"rerender_async").name("Render");t.open();return null};t.prototype.march_async=function(e,t){var i,n,o,s,r,a,l,h;if(t==null){t="marchingCubes"}l=this;n=this.debug;window.URL=window.URL||window.webkitURL;s=this.func.toString();r=null;if(this.algorithm==="marchingCubes"){r=marchingCubes.toString()}else if(this.algorithm==="marchingTetrahedra"){r=marchingTetrahedra.toString()}else if(this.algorithm==="surfaceNets"){r=surfaceNets.toString()}a=""+t+" = "+r+"\nself.onmessage = function (e) {\n  output = "+t+"(["+this.resolution+", "+this.resolution+", "+this.resolution+"], "+s+", [["+this.xmin+", "+this.ymin+", "+this.zmin+"],["+this.xmax+", "+this.ymax+", "+this.zmax+"]]);\n  postMessage(output);\n  }";i=null;try{i=new Blob([a],{type:"application/javascript"})}catch(u){o=u;window.BlobBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder;i=new BlobBuilder;i.append(a);i=i.getBlob()}h=new Worker(URL.createObjectURL(i));h.onmessage=function(t){var i,n,o,s,r,a;r=t.data;n=r.positions;i=r.normals;o=new THREE.BufferGeometry;o.addAttribute("position",new THREE.BufferAttribute(n,3));o.addAttribute("normal",new THREE.BufferAttribute(i,3));a=o;s=new THREE.Mesh(a,l.material);if(e){if(l.mathScene!=null){l.mathScene.scene.remove(l.surface);console.log("surface removed");l.surface=s;console.log("surface constructed");l.mathScene.scene.add(l.surface);console.log("surface embedded");l.embedCallback()}}else{if(l.mathScene!=null){l.mathScene.scene.remove(l.surface);l.surface=s;l.mathScene.scene.add(l.surface);l.mathScene.render();l.embedCallback()}}return null};h.postMessage("Go!");return null};t.prototype.modify=function(e){var t,i;i=e.clone();i.mergeVertices();t=new THREE.SubdivisionModifier(this.smoothingLevel);t.modify(i);return i};return t}(i);s=function(e){a(t,e);t.prototype.origin=null;t.prototype.vector=null;t.prototype.arrow=null;function t(e){var t,i,n,o;n=e.origin,o=e.vector,t=e.color;if(n==null){n=[0,0,0]}this.orig=new THREE.Vector3(n[0],n[1],n[2]);if(o==null){o=[1,0,0]}this.vec=new THREE.Vector3(o[0],o[1],o[2]);if(t==null){t=16711935}this.col=t;i=this.vec.clone().normalize();this.arrow=new THREE.ArrowHelper(i,this.orig.clone(),this.vec.length(),this.col);this.arrow.cone.material=new THREE.MeshLambertMaterial({ambient:this.col,color:13421772,opacity:1});return}t.prototype.embedObjects=function(){this.mathScene.scene.add(this.arrow);return null};return t}(i);o=function(e){a(t,e);t.prototype.normal=null;t.prototype.position=null;t.prototype.xrange=null;t.prototype.yrange=null;function t(e){var t,i,n,o,s,r;i=e.normal,n=e.position,s=e.xrange,r=e.yrange,t=e.color;if(n==null){n=[0,0,0]}this.position=new THREE.Vector3(n[0],n[1],n[2]);if(i==null){i=[0,0,1]}this.normal=new THREE.Vector3(i[0],i[1],i[2]);if(s==null){s=[-2,2]}if(r==null){r=[-2,2]}this.xrange=s;this.yrange=r;if(t==null){t=5592405}this.color=t;this.plane=new THREE.Mesh(new THREE.PlaneGeometry(this.xrange[1]-this.xrange[0],this.yrange[1]-this.yrange[0]),new THREE.MeshPhongMaterial({ambient:this.color,color:1118481,specular:789516,shininess:60,side:THREE.DoubleSide}));this.plane.position=this.position;this.plane.quaternion=this.plane.quaternion.setFromUnitVectors(new THREE.Vector3(0,0,1),this.normal.normalize());this.plane.receiveShadow=true;this.spotLight=new THREE.DirectionalLight(16777215,1);o=10;this.spotLight.position.set(o*i[0],o*i[1],o*i[2]);this.spotLight.castShadow=true;this.spotLight.shadowDarkness=1;this.spotLight.shadowCameraFar=20;this.spotLight.shadowCameraNear=1;this.spotLight.shadowCameraLeft=-10;this.spotLight.shadowCameraRight=10;this.spotLight.shadowCameraBottom=-10;this.spotLight.shadowCameraTop=10;return}t.prototype.embedObjects=function(){this.mathScene.enableShadow();this.mathScene.scene.add(this.plane);this.mathScene.scene.add(this.spotLight)};return t}(i);window.MathModel=i;window.ParametricPathModel=n;window.MarchingCubesModel=t;window.VectorModel=s;window.PlaneShadowModel=o}).call(this);